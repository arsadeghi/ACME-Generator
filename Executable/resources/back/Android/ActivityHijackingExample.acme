import families/Android.acme;
system IntentHijackingExample : Android = new Android extended with {
  component Activity1 : ActivityComponentT = new ActivityComponentT extended with {
     port ImplicitIntentBroadcastAnnouncerPortT0 : ImplicitIntentBroadcastAnnouncerPortT = new ImplicitIntentBroadcastAnnouncerPortT extended with {
        property action = "android.intent.IHE_INTENT";

        };
        property state = Created;
        property class = "Activity1";
        property intentFilters = {
           "android.intent.IHE_INTENT" };
        property exported = true;

    };
    component Activity2 : ActivityComponentT = new ActivityComponentT extended with {
       port ImplicitIntentBroadcastReceivePortT0 : ImplicitIntentBroadcastReceivePortT = new ImplicitIntentBroadcastReceivePortT;
       property state = Created;
       property class = "Activity2";
       property intentFilters = {"android.intent.IHE_INTENT"};
       property exported = true;

    };
    component MaliciousActivity : ActivityComponentT = new ActivityComponentT extended with {
       port ImplicitIntentBroadcastReceivePortT0 : ImplicitIntentBroadcastReceivePortT = new ImplicitIntentBroadcastReceivePortT;
       property state = Created;
       property class = "MaliciousActivity";
       property intentFilters = {"android.intent.IHE_INTENT"};
       property exported = true;

    };
    connector ImplicitIntentBus = {
       role r_ImplicitIntentBroadcastAnnounceRoleT : ImplicitIntentBroadcastAnnounceRoleT = new ImplicitIntentBroadcastAnnounceRoleT;
       role r_ImplicitIntentBroadcastReceiveRoleT : ImplicitIntentBroadcastReceiveRoleT = new ImplicitIntentBroadcastReceiveRoleT;
       role r_ImplicitIntentBroadcastReceiveRoleT0 : ImplicitIntentBroadcastReceiveRoleT = new ImplicitIntentBroadcastReceiveRoleT;

    };
    attachment Activity1.ImplicitIntentBroadcastAnnouncerPortT0 to ImplicitIntentBus.r_ImplicitIntentBroadcastAnnounceRoleT;
    attachment MaliciousActivity.ImplicitIntentBroadcastReceivePortT0 to ImplicitIntentBus.r_ImplicitIntentBroadcastReceiveRoleT;
    attachment Activity2.ImplicitIntentBroadcastReceivePortT0 to ImplicitIntentBus.r_ImplicitIntentBroadcastReceiveRoleT0;
    group App1 : AndroidApplicationGroupT = new AndroidApplicationGroupT extended with {
       members {Activity1}

    };
    group App2 : AndroidApplicationGroupT = new AndroidApplicationGroupT extended with {
       members {Activity2}

    };
    group MaliciousApp : AndroidApplicationGroupT = new AndroidApplicationGroupT extended with {
       members {MaliciousActivity}

    };
}